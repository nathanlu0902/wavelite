{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _definitions = require(\"./definitions\");\n\nvar _definitions2 = _interopRequireDefault(_definitions);\n\nexports[\"default\"] = function (_ref) {\n  var Plugin = _ref.Plugin;\n  var t = _ref.types;\n\n  var RUNTIME_MODULE_NAME = \"babel-runtime\";\n\n  function has(obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n  }\n\n  return new Plugin(\"runtime\", {\n    metadata: {\n      group: \"builtin-post-modules\"\n    },\n\n    pre: function pre(file) {\n      file.set(\"helperGenerator\", function (name) {\n        return file.addImport(RUNTIME_MODULE_NAME + \"/helpers/\" + name, name, \"absoluteDefault\");\n      });\n\n      file.setDynamic(\"regeneratorIdentifier\", function () {\n        return file.addImport(RUNTIME_MODULE_NAME + \"/regenerator\", \"regeneratorRuntime\", \"absoluteDefault\");\n      });\n    },\n\n    visitor: {\n      ReferencedIdentifier: function ReferencedIdentifier(node, parent, scope, file) {\n        if (node.name === \"regeneratorRuntime\") {\n          return file.get(\"regeneratorIdentifier\");\n        }\n\n        if (t.isMemberExpression(parent)) return;\n        if (!has(_definitions2[\"default\"].builtins, node.name)) return;\n        if (scope.getBindingIdentifier(node.name)) return;\n\n        // Symbol() -> _core.Symbol(); new Promise -> new _core.Promise\n        var modulePath = _definitions2[\"default\"].builtins[node.name];\n        return file.addImport(RUNTIME_MODULE_NAME + \"/core-js/\" + modulePath, node.name, \"absoluteDefault\");\n      },\n\n      CallExpression: function CallExpression(node, parent, scope, file) {\n        // arr[Symbol.iterator]() -> _core.$for.getIterator(arr)\n\n        if (node.arguments.length) return;\n\n        var callee = node.callee;\n        if (!t.isMemberExpression(callee)) return;\n        if (!callee.computed) return;\n        if (!this.get(\"callee.property\").matchesPattern(\"Symbol.iterator\")) return;\n\n        return t.callExpression(file.addImport(RUNTIME_MODULE_NAME + \"/core-js/get-iterator\", \"getIterator\", \"absoluteDefault\"), [callee.object]);\n      },\n\n      BinaryExpression: function BinaryExpression(node, parent, scope, file) {\n        // Symbol.iterator in arr -> core.$for.isIterable(arr)\n\n        if (node.operator !== \"in\") return;\n        if (!this.get(\"left\").matchesPattern(\"Symbol.iterator\")) return;\n\n        return t.callExpression(file.addImport(RUNTIME_MODULE_NAME + \"/core-js/is-iterable\", \"isIterable\", \"absoluteDefault\"), [node.right]);\n      },\n\n      MemberExpression: {\n        enter: function enter(node, parent, scope, file) {\n          // Array.from -> _core.Array.from\n\n          if (!this.isReferenced()) return;\n\n          var obj = node.object;\n          var prop = node.property;\n\n          if (!t.isReferenced(obj, node)) return;\n\n          if (node.computed) return;\n\n          if (!has(_definitions2[\"default\"].methods, obj.name)) return;\n\n          var methods = _definitions2[\"default\"].methods[obj.name];\n          if (!has(methods, prop.name)) return;\n\n          // doesn't reference the global\n          if (scope.getBindingIdentifier(obj.name)) return;\n\n          // special case Object.defineProperty to not use core-js when using string keys\n          if (obj.name === \"Object\" && prop.name === \"defineProperty\" && this.parentPath.isCallExpression()) {\n            var call = this.parentPath.node;\n            if (call.arguments.length === 3 && t.isLiteral(call.arguments[1])) return;\n          }\n\n          var modulePath = methods[prop.name];\n          return file.addImport(RUNTIME_MODULE_NAME + \"/core-js/\" + modulePath, obj.name + \"$\" + prop.name, \"absoluteDefault\");\n        },\n\n        exit: function exit(node, parent, scope, file) {\n          if (!this.isReferenced()) return;\n\n          var prop = node.property;\n          var obj = node.object;\n\n          if (!has(_definitions2[\"default\"].builtins, obj.name)) return;\n          if (scope.getBindingIdentifier(obj.name)) return;\n\n          var modulePath = _definitions2[\"default\"].builtins[obj.name];\n          return t.memberExpression(file.addImport(RUNTIME_MODULE_NAME + \"/core-js/\" + modulePath, \"\" + obj.name, \"absoluteDefault\"), prop);\n        }\n      }\n    }\n  });\n};\n\nmodule.exports = exports[\"default\"];"]}